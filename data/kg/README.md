# Knowledge Graph Repository

## ğŸ“‹ Overview

This directory contains the **Task-Scene Based Knowledge Graphs** for the KGRL (Knowledge Graph Enhanced Reinforcement Learning) project. All KGs are built from **100% real TextWorld game data** without any simulated content.

## ğŸ“ Directory Structure

```
data/kg/
â”œâ”€â”€ README.md                           # This file
â”œâ”€â”€ extracted/                          # Reference templates
â”‚   â””â”€â”€ enhanced_example_kg.json        # Original design reference template
â”œâ”€â”€ schemas/                            # KG schema definitions
â”‚   â””â”€â”€ enhanced_kg_schema.yaml         # KG schema specification
â””â”€â”€ task_scenes/                        # Task-scene based KGs (NEW)
    â”œâ”€â”€ TextWorld_tw-another_game_task_kg.json
    â”œâ”€â”€ TextWorld_tw-rewardsBalanced_goalBrief_task_kg.json
    â”œâ”€â”€ TextWorld_tw-rewardsBalanced_goalDetailed_task_kg.json
    â”œâ”€â”€ TextWorld_tw-rewardsDense_goalBrief_task_kg.json
    â”œâ”€â”€ TextWorld_tw-rewardsDense_goalDetailed_task_kg.json
    â”œâ”€â”€ TextWorld_tw-rewardsSparse_goalBrief_task_kg.json
    â”œâ”€â”€ TextWorld_tw-rewardsSparse_goalDetailed_task_kg.json
    â”œâ”€â”€ TextWorld_tw-rewardsSparse_goalNone_task_kg.json
    â””â”€â”€ task_scenes_summary.json         # Batch processing summary
```

## ğŸ¯ Task-Scene Based Knowledge Graphs

### **Concept**
- **Physical Scene**: All 8 games share the same 6-room layout (kitchen, bedroom, living room, bathroom, backyard, garden)
- **Task Scene**: Each game has unique objectives, reward structures, item configurations, and walkthrough steps
- **Strategy**: Generate independent KG for each task scene to preserve task-specific information

### **8 Task Scenes**

| Task Scene | Nodes | Edges | Actions | Description |
|------------|-------|-------|---------|-------------|
| `tw-another_game` | 173 | 51 | 9 | Independent game scenario |
| `tw-rewardsBalanced_goalBrief` | 180 | 67 | 12 | Balanced rewards + brief goal |
| `tw-rewardsBalanced_goalDetailed` | 180 | 67 | 12 | Balanced rewards + detailed goal |
| `tw-rewardsDense_goalBrief` | 180 | 67 | 12 | Dense rewards + brief goal |
| `tw-rewardsDense_goalDetailed` | 180 | 67 | 12 | Dense rewards + detailed goal |
| `tw-rewardsSparse_goalBrief` | 180 | 67 | 12 | Sparse rewards + brief goal |
| `tw-rewardsSparse_goalDetailed` | 180 | 67 | 12 | Sparse rewards + detailed goal |
| `tw-rewardsSparse_goalNone` | 180 | 67 | 12 | Sparse rewards + no goal description |

### **Key Features**
- âœ… **100% Real Data**: All entities use real names from TextWorld games
- âœ… **Complete Action Parsing**: All walkthrough steps successfully parsed
- âœ… **Rich Entity Names**: `kitchen`, `wooden door`, `antique trunk`, `old key`, `milk`, `carrot`, etc.
- âœ… **Complex Actions**: `take X from Y`, `unlock X with Y`, `put X on Y`, etc.
- âœ… **Task Metadata**: Objectives, max scores, walkthrough steps included

## ğŸ”§ KG Schema

### **Node Types**
- **entity**: Game entities (rooms, objects, player, scene)
- **state**: Entity states with preconditions and effects
- **action**: Parsed actions from walkthrough steps
- **result**: Action outcomes and effects

### **Edge Types**
- **requires**: Action requires specific entities/states
- **modifies**: Action modifies entity states
- **produces**: Action produces specific results
- **transitions**: State transitions between actions

### **Entity Types**
- **åœºæ™¯** (scene): Game scenario
- **è§’è‰²** (character): Player
- **æˆ¿é—´** (room): Game rooms
- **é—¨** (door): Doors between rooms
- **å®¹å™¨** (container): Containers and storage
- **é£Ÿç‰©** (food): Food items
- **ç‰©å“** (object): General objects
- **æ”¯æ’‘é¢** (supporter): Surfaces and supporters

## ğŸ“Š Quality Metrics

### **Entity Name Mapping Success Rate: 100%**
- All entities use real names instead of IDs
- Examples: `r_1` â†’ `kitchen`, `c_0` â†’ `antique trunk`, `d_0` â†’ `wooden door`

### **Action Parsing Success Rate: 100%**
- All walkthrough steps successfully parsed into actions
- Complex command formats fully supported

### **Data Integrity: 100%**
- No simulated or hardcoded data used
- All information extracted from real TextWorld game files

## ğŸš€ Usage

### **For RL Training**
Each task scene KG can be used independently for training RL agents with different reward structures and objectives.

### **For Research**
Compare agent performance across different reward settings (dense vs sparse) and goal descriptions (brief vs detailed vs none).

### **For Visualization**
Import any KG into Neo4j for interactive visualization and exploration.

## ğŸ“ Generation Details

- **Generated by**: `scripts/data/textworld_real_kg_builder.py`
- **Source data**: `data/benchmarks/textworld/TextWorld/notebooks/games/*.z8`
- **Generation date**: Latest batch processing
- **Schema version**: 2.0
- **Success rate**: 8/8 (100%)

## ğŸ”„ Next Steps

1. **Neo4j Import**: Test importing KGs into Neo4j for visualization
2. **RL Integration**: Integrate KGs with RL agents for training
3. **Performance Analysis**: Compare agent performance across different task scenes
